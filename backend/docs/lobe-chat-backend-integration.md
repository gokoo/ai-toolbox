# Lobe Chat åç«¯é›†æˆæ–‡æ¡£

## 1. é¡¹ç›®æ¦‚è¿°

æœ¬æ–‡æ¡£æ€»ç»“äº†åŸºäº Lobe Chat æ¡†æ¶å¼€å‘çš„ AI å·¥å…·ç®±åç«¯é›†æˆè¦ç‚¹ï¼Œæ—¨åœ¨ç¡®ä¿åç«¯å®ç°ä¸ Lobe Chat å‰ç«¯æ¡†æ¶çš„å…¼å®¹æ€§å’Œä¸€è‡´æ€§ã€‚

## 2. æ•°æ®æ¨¡å‹å¯¹æ¯”

### 2.1 Session æ¨¡å‹

| å‰ç«¯æœŸæœ›å­—æ®µ | åç«¯å®ç°å­—æ®µ | åŒ¹é…çŠ¶æ€ | è¯´æ˜ |
|------------|------------|---------|------|
| id | _id | âœ… | MongoDB ä½¿ç”¨ _id ä½œä¸ºä¸»é”® |
| topic | topic | âœ… | ä¼šè¯ä¸»é¢˜ |
| favorite | favorite | âœ… | æ˜¯å¦æ”¶è— |
| pinned | pinned | âœ… | æ˜¯å¦ç½®é¡¶ |
| archived | archived | âœ… | æ˜¯å¦å½’æ¡£ |
| agentId | agentId | âœ… | å…³è”çš„ AI åŠ©æ‰‹ ID |
| metadata | metadata | âœ… | ä¼šè¯å…ƒæ•°æ® |
| createdAt | createdAt | âœ… | åˆ›å»ºæ—¶é—´ |
| updatedAt | updatedAt | âœ… | æ›´æ–°æ—¶é—´ |
| lastMessageId | lastMessageId | âœ… | æœ€åä¸€æ¡æ¶ˆæ¯ ID |
| lastMessageCreatedAt | lastMessageCreatedAt | âœ… | æœ€åä¸€æ¡æ¶ˆæ¯åˆ›å»ºæ—¶é—´ |

### 2.2 Message æ¨¡å‹

| å‰ç«¯æœŸæœ›å­—æ®µ | åç«¯å®ç°å­—æ®µ | åŒ¹é…çŠ¶æ€ | è¯´æ˜ |
|------------|------------|---------|------|
| id | _id | âœ… | MongoDB ä½¿ç”¨ _id ä½œä¸ºä¸»é”® |
| sessionId | sessionId | âœ… | å…³è”çš„ä¼šè¯ ID |
| role | role | âœ… | æ¶ˆæ¯è§’è‰²ï¼ˆuser/assistant/systemï¼‰ |
| content | content | âœ… | æ¶ˆæ¯å†…å®¹ |
| meta | meta | âœ… | æ¶ˆæ¯å…ƒæ•°æ® |
| createdAt | createdAt | âœ… | åˆ›å»ºæ—¶é—´ |
| updatedAt | updatedAt | âœ… | æ›´æ–°æ—¶é—´ |
| parentId | parentId | âœ… | çˆ¶æ¶ˆæ¯ IDï¼ˆç”¨äºæ¶ˆæ¯æ ‘ç»“æ„ï¼‰ |
| quotaId | quotaId | âœ… | å¼•ç”¨æ¶ˆæ¯ ID |
| plugin | plugin | âœ… | æ’ä»¶ç›¸å…³ä¿¡æ¯ |
| files | files | âœ… | å…³è”æ–‡ä»¶ |

## 3. API æ¥å£è¯„ä¼°

### 3.1 Session æ¥å£

| å‰ç«¯æœŸæœ›æ¥å£ | åç«¯å®ç°æ¥å£ | åŒ¹é…çŠ¶æ€ | è¯´æ˜ |
|------------|------------|---------|------|
| getSessions | GET /api/sessions | âœ… | è·å–ç”¨æˆ·ä¼šè¯åˆ—è¡¨ |
| createSession | POST /api/sessions | âœ… | åˆ›å»ºæ–°ä¼šè¯ |
| getSession | GET /api/sessions/:id | âœ… | è·å–å•ä¸ªä¼šè¯è¯¦æƒ… |
| updateSession | PATCH /api/sessions/:id | âœ… | æ›´æ–°ä¼šè¯ä¿¡æ¯ |
| deleteSession | DELETE /api/sessions/:id | âœ… | åˆ é™¤ä¼šè¯ |
| clearSessionMessages | DELETE /api/sessions/:id/messages | âœ… | æ¸…ç©ºä¼šè¯æ¶ˆæ¯ |
| getSessionMessages | GET /api/sessions/:id/messages | âœ… | è·å–ä¼šè¯æ¶ˆæ¯åˆ—è¡¨ |

### 3.2 Plugin æ¥å£

| å‰ç«¯æœŸæœ›æ¥å£ | åç«¯å®ç°æ¥å£ | åŒ¹é…çŠ¶æ€ | è¯´æ˜ |
|------------|------------|---------|------|
| getInstalledPlugins | GET /api/plugins | ğŸ”„ | è·å–å·²å®‰è£…æ’ä»¶åˆ—è¡¨ |
| installPlugin | POST /api/plugins | ğŸ”„ | å®‰è£…æ–°æ’ä»¶ |
| uninstallPlugin | DELETE /api/plugins/:id | ğŸ”„ | å¸è½½æ’ä»¶ |
| updatePlugin | PATCH /api/plugins/:id | ğŸ”„ | æ›´æ–°æ’ä»¶ä¿¡æ¯ |
| updatePluginSettings | PATCH /api/plugins/:id/settings | ğŸ”„ | æ›´æ–°æ’ä»¶è®¾ç½® |
| createCustomPlugin | POST /api/plugins/custom | ğŸ”„ | åˆ›å»ºè‡ªå®šä¹‰æ’ä»¶ |

## 4. å¼€å‘é‡Œç¨‹ç¢‘

### 4.1 åŸºç¡€åŠŸèƒ½å®Œå–„ï¼ˆå½“å‰é˜¶æ®µï¼‰

- [x] ç”¨æˆ·è®¤è¯ä¸æˆæƒç³»ç»Ÿ
- [x] ä¼šè¯ç®¡ç† CRUD æ“ä½œ
- [x] æ¶ˆæ¯ç®¡ç† CRUD æ“ä½œ
- [ ] æ–‡ä»¶ä¸Šä¼ ä¸ç®¡ç†
- [ ] åŸºæœ¬ AI æ¨¡å‹é›†æˆ

### 4.2 é«˜çº§åŠŸèƒ½å¼€å‘

- [ ] å¤šæ¨¡å‹æ”¯æŒï¼ˆOpenAIã€Azureã€æœ¬åœ°æ¨¡å‹ç­‰ï¼‰
- [ ] ä¼šè¯å¯¼å‡º/å¯¼å…¥åŠŸèƒ½
- [ ] ç”¨æˆ·åå¥½è®¾ç½®
- [ ] å¤šè¯­è¨€æ”¯æŒ
- [ ] é«˜çº§æœç´¢ä¸è¿‡æ»¤

### 4.3 æ’ä»¶ç³»ç»Ÿé›†æˆ

- [ ] æ’ä»¶ç®¡ç†æ¥å£
- [ ] æ’ä»¶å®‰è£…ä¸å¸è½½
- [ ] æ’ä»¶è®¾ç½®ç®¡ç†
- [ ] è‡ªå®šä¹‰æ’ä»¶åˆ›å»º
- [ ] æ’ä»¶æƒé™æ§åˆ¶

### 4.4 æ€§èƒ½ä¼˜åŒ–

- [ ] æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–
- [ ] ç¼“å­˜ç­–ç•¥å®ç°
- [ ] æ¶ˆæ¯åˆ†é¡µä¸æ‡’åŠ è½½
- [ ] å¤§å‹ä¼šè¯æ€§èƒ½ä¼˜åŒ–
- [ ] æœåŠ¡å™¨èµ„æºä½¿ç”¨ç›‘æ§

### 4.5 å®‰å…¨å¢å¼º

- [ ] API é€Ÿç‡é™åˆ¶
- [ ] æ•°æ®åŠ å¯†å­˜å‚¨
- [ ] æ•æ„Ÿä¿¡æ¯è¿‡æ»¤
- [ ] å®‰å…¨å®¡è®¡æ—¥å¿—
- [ ] CSRF/XSS é˜²æŠ¤å¢å¼º

## 5. æŠ€æœ¯æ ˆæ€»ç»“

### 5.1 å‰ç«¯ï¼ˆLobe Chatï¼‰

- Next.js 14+
- React 18+
- TypeScript
- Tailwind CSS
- Lobe UI ç»„ä»¶åº“
- IndexedDB/LocalStorageï¼ˆå®¢æˆ·ç«¯å­˜å‚¨ï¼‰
- WebSocketï¼ˆå®æ—¶é€šä¿¡ï¼‰

### 5.2 åç«¯ï¼ˆè‡ªå®šä¹‰å®ç°ï¼‰

- Node.js 22+
- Express.js
- MongoDB
- JWT è®¤è¯
- OpenAI API é›†æˆ
- äº‘å­˜å‚¨é›†æˆï¼ˆé˜¿é‡Œäº‘/è…¾è®¯äº‘ï¼‰
- WebSocket æœåŠ¡

## 6. å¼€å‘æ³¨æ„äº‹é¡¹

### 6.1 å‰åç«¯å…¼å®¹æ€§

- ä¸¥æ ¼éµå¾ª Lobe Chat å‰ç«¯çš„æ•°æ®ç»“æ„å’Œå­—æ®µå‘½å
- ä¿æŒ API å“åº”æ ¼å¼ä¸å‰ç«¯æœŸæœ›ä¸€è‡´
- å®ç°æ‰€æœ‰å‰ç«¯ä¾èµ–çš„ API ç«¯ç‚¹
- ç¡®ä¿é”™è¯¯å¤„ç†ä¸å‰ç«¯é¢„æœŸåŒ¹é…

### 6.2 æ’ä»¶ç³»ç»Ÿå¼€å‘

- éµå¾ª Lobe Chat æ’ä»¶ SDK è§„èŒƒ
- ç¡®ä¿æ’ä»¶æ¸…å•ï¼ˆmanifestï¼‰æ ¼å¼æ­£ç¡®
- å®ç°æ’ä»¶æ‰€éœ€çš„åç«¯ API æ”¯æŒ
- æä¾›æ’ä»¶è®¾ç½®çš„æŒä¹…åŒ–å­˜å‚¨

### 6.3 å®‰å…¨è€ƒè™‘

- æ‰€æœ‰ API ç«¯ç‚¹éœ€è¦é€‚å½“çš„è®¤è¯å’Œæˆæƒ
- å®ç° API å¯†é’¥å’Œæ•æ„Ÿä¿¡æ¯çš„å®‰å…¨å­˜å‚¨
- é˜²æ­¢ SQL æ³¨å…¥å’Œ NoSQL æ³¨å…¥æ”»å‡»
- å®ç°é€‚å½“çš„ CORS ç­–ç•¥

### 6.4 æ€§èƒ½ä¼˜åŒ–

- å®ç°æ•°æ®åˆ†é¡µä»¥å¤„ç†å¤§é‡è®°å½•
- ä½¿ç”¨é€‚å½“çš„ç¼“å­˜ç­–ç•¥å‡å°‘æ•°æ®åº“è´Ÿè½½
- ä¼˜åŒ–å¤§å‹ä¼šè¯å’Œæ¶ˆæ¯å†å²çš„åŠ è½½
- è€ƒè™‘ä½¿ç”¨æµå¼å“åº”å¤„ç†é•¿æ–‡æœ¬ç”Ÿæˆ

## 7. ä¸‹ä¸€æ­¥å·¥ä½œ

1. å®Œæˆæ’ä»¶ç®¡ç† API çš„å®ç°
2. é›†æˆæ–‡ä»¶ä¸Šä¼ å’Œç®¡ç†åŠŸèƒ½
3. å®ç° AI æ¨¡å‹è°ƒç”¨çš„ä»£ç†å’Œç¼“å­˜
4. æ·»åŠ ç”¨æˆ·åå¥½è®¾ç½®çš„æŒä¹…åŒ–
5. å¼€å‘ä¼šè¯å¯¼å‡º/å¯¼å…¥åŠŸèƒ½
6. å®ç°åŸºæœ¬çš„ç›‘æ§å’Œæ—¥å¿—ç³»ç»Ÿ

## 8. å‚è€ƒèµ„æº

- [Lobe Chat GitHub ä»“åº“](https://github.com/lobehub/lobe-chat)
- [Lobe Chat æ’ä»¶ SDK æ–‡æ¡£](https://github.com/lobehub/chat-plugin-sdk)
- [Lobe Chat æ•°æ®åº“æ¨¡å‹å®šä¹‰](https://github.com/lobehub/lobe-chat/tree/main/src/database/schemas)
- [Lobe Chat API æœåŠ¡å®šä¹‰](https://github.com/lobehub/lobe-chat/tree/main/src/services)